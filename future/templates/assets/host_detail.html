{% extends 'base.html' %}
{% load humanize %}
{% load business_tag %}
{% block title %} 详细信息 {% endblock %}
{% block css %}
<link rel="stylesheet" href="/static/CSS/new_style.css">
<link rel="stylesheet" href="/static/CSS/animate.css">
{% endblock %}
{% block content %}
<section class="content-header">
  <h1>
    <b>追梦</b>-主机管理
  </h1>
  <ol class="breadcrumb">
    <li><a href="#"><i class="fa fa-dashboard"></i> 主页</a></li>
    <li><a href="#">资产</a></li>
    <li class="active">主机</li>
  </ol>
</section>
<section class="content">
  <div class="row">
    <div class="col-lg-4">
      <div class="box box-primary">
        <div class="box-header with-border">
          <i class="fa fa-fw fa-file"></i>
          <h3 class="box-title"><b>{{ host.eth1 }}</b></h3>

          <div class="box-tools pull-right">
            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
            </button>
            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
          </div>
        </div>
        <div class="box-body">
          <div class="ibox-content ibox-heading">
            <h3>主机基本信息</h3>
            <small><i class="fa fa-map-marker"></i> 此主机基本信息.</small>
          </div>
          <div class="ibox-content">
            <div>
              <div class="text-left">
                <table class="table">
                  <tr>
                    <td class="K-text-navy">IP</td>
                    <td>{{ host.eth1 }}</td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">内网IP</td>
                    <td>{{ host.internal_ip}}</td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">所属业务</td>
                    <td>{{  host.business.project_name }}-{{  host.business.business_name }}</td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">服务</td>
                    <td>{{ host.get_server_type_display }}</td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">环境</td>
                    <td>{{ host.business.get_use_name_display }}</td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">主机类型</td>
                    <td>{{ host.get_type_display }}</td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">IDC</td>
                    <td>{{ host.idc.name }} </td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">CPU</td>
                    <td>{{ host.cpu }}</td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">内存</td>
                    <td>{{ host.memory }} </td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">硬盘</td>
                    <td>{{ host.hard_disk }} </td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">机器状态</td>
                    <td>{{ host.get_status_display }}</td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">操作系统</td>
                    <td>{{ host.get_system_display }} - {{ host.system_version }} </td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">添加日期</td>
                    <td>{{ host.create_time|date:"Y-m-d" }}</td>
                  </tr>
                  <tr>
                    <td class="K-text-navy">备注</td>
                    <td>{{ host.editor }}</td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-5">
      <div class="box box-info">
        <div class="box-header with-border">
          <i class="fa fa-fw fa-area-chart"></i>
          <h4 class="box-title"><b>主机监控</b></h4>
          <div class="box-tools pull-right">
            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
            </button>
            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
          </div>
        </div>
        <div class="box-body">
          <div class="ibox-content ibox-heading">
            <h3>主机基本监控信息</h3>
            <small><i class="fa fa-map-marker"></i> 包含了此主机所有授权的用户</small>
          </div>
          <div class="box box-info">
            <div class="box-header with-border">
              <h3 class="box-title">Line Chart</h3>
            </div>
            <div class="box-body">
              <div class="chart">
                <canvas id="lineChart" style="height:250px"></canvas>
                 <div id="container" style="max-width:800px;height:400px"></div>
              </div>
            </div>
            <!-- /.box-body -->
          </div>
          <!-- /.box -->
        </div>
      </div>
    </div>
    <div class="col-lg-3">
      <div class="box box-success">
        <div class="box-header with-border">
          <i class="fa fa-fw fa-calendar"></i>
          <h4 class="box-title"><b>操作日志</b></h4>
          <div class="box-tools pull-right">
            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
            </button>
            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
          </div>
        </div>
        <div class="box-body">
          <div class="ibox-content ibox-heading">
            <h3>主机修改历史记录</h3>
            <small><i class="fa fa-map-marker"></i> 此主机所有修改历史记录.</small>
          </div>
          <div class="ibox-content">
            <div class="feed-activity-list">
              {% if host_record %}
              {% for i in host_record %}
              <div class="feed-element">
                <div>
                  <small class="pull-right">{{ i.time|naturaltime }}</small>
                  <strong class="text-navy">{{ i.user }}</strong>
                  {% for r in i.content|str_to_list %}
                  <div>{{ r }}</div>
                  {% endfor %}
                  <small class="text-success">{{i.time}}</small>
                </div>
              </div>
              {% endfor %}
              {% else %}
              <p class="text-center">(暂无)</p>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
</section>
{% endblock %}

{% block script %}
<script src="/static/JS/highcharts.js"></script>
<script>
  var chart = Highcharts.chart('container', {
		title: {
				text: '2010 ~ 2016 年太阳能行业就业人员发展情况'
		},
		subtitle: {
				text: '数据来源：thesolarfoundation.com'
		},
		yAxis: {
				title: {
						text: '就业人数'
				}
		},
		legend: {
				layout: 'vertical',
				align: 'right',
				verticalAlign: 'middle'
		},
		plotOptions: {
				series: {
						label: {
								connectorAllowed: false
						},
						pointStart: 2010
				}
		},
		series: [{
				name: '安装，实施人员',
				data: [43934, 52503, 57177, 69658, 97031, 119931, 137133, 154175]
		}, {
				name: '工人',
				data: [24916, 24064, 29742, 29851, 32490, 30282, 38121, 40434]
		}, {
				name: '销售',
				data: [11744, 17722, 16005, 19771, 20185, 24377, 32147, 39387]
		}, {
				name: '项目开发',
				data: [null, null, 7988, 12169, 15112, 22452, 34400, 34227]
		}, {
				name: '其他',
				data: [12908, 5948, 8105, 11248, 8989, 11816, 18274, 18111]
		}],
		responsive: {
				rules: [{
						condition: {
								maxWidth: 500
						},
						chartOptions: {
								legend: {
										layout: 'horizontal',
										align: 'center',
										verticalAlign: 'bottom'
								}
						}
				}]
		}
  });
</script>
{% endblock %}